<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RatScape - Car Meet Platform</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#8B0000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="RatScape">
    <meta name="description" content="The ultimate car and bike meetup platform. Find meets, connect with enthusiasts, and share your passion.">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="192x192" href="/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="/icon-512x512.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-32x32.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <script>
        // ŒíŒüŒóŒòŒóŒ§ŒôŒöŒó Œ£Œ•ŒùŒëŒ°Œ§ŒóŒ£Œó: ŒëœÄŒøŒ∏ŒÆŒ∫ŒµœÖœÉŒ∑ œÑŒ∑œÇ œÑœÅŒ≠œáŒøœÖœÉŒ±œÇ œÉŒµŒªŒØŒ¥Œ±œÇ Œ†Œ°ŒôŒù œÑŒø refresh
        window.addEventListener('beforeunload', function() {
            if (window.currentPageId) {
                localStorage.setItem('ratscape_last_page', window.currentPageId);
            }
        });
        
        // ŒíŒüŒóŒòŒóŒ§ŒôŒöŒó Œ£Œ•ŒùŒëŒ°Œ§ŒóŒ£Œó: ŒëŒΩŒ¨Œ∫œÑŒ∑œÉŒ∑ œÑŒ∑œÇ œÑŒµŒªŒµœÖœÑŒ±ŒØŒ±œÇ œÉŒµŒªŒØŒ¥Œ±œÇ
        function getLastPageId() {
            return localStorage.getItem('ratscape_last_page') || 'home-page';
        }
        
        // ŒíŒüŒóŒòŒóŒ§ŒôŒöŒó Œ£Œ•ŒùŒëŒ°Œ§ŒóŒ£Œó: ŒüœÅŒπœÉŒºœåœÇ œÑŒ∑œÇ œÑœÅŒ≠œáŒøœÖœÉŒ±œÇ œÉŒµŒªŒØŒ¥Œ±œÇ
        function setCurrentPageId(pageId) {
            window.currentPageId = pageId;
        }
    </script>
</head>

<body>
    <!-- PWA FLOATING INSTALL BUTTON -->
    <button id="pwa-install-btn" class="pwa-floating-install-button" style="display: none;" onclick="installPWA()">
        <i class="fas fa-download"></i>
        <span class="install-text">Download RatScape</span>
    </button>

    <!-- HEADER NAVIGATION -->
    <nav id="main-nav">
        <div class="nav-brand">
            <button id="home-btn" class="nav-btn">
                <img src="logo.jpg.jpg" alt="RatScape" class="nav-logo" style="height: 62px; width: auto;">
            </button>
        </div>
        
        <div class="nav-actions" id="nav-logged-out">
            <button id="login-nav-btn" class="nav-btn"><i class="fas fa-sign-in-alt"></i> Login</button>
            <button id="register-nav-btn" class="nav-btn"><i class="fas fa-user-plus"></i> Register</button>
        </div>
        <div class="nav-actions" id="nav-logged-in" style="display: none;">
            <span id="nav-username" class="nav-username"></span>
            <button id="my-friends-btn" class="nav-btn"><i class="fas fa-users"></i> Friends</button>
            <button id="my-rooms-btn" class="nav-btn"><i class="fas fa-comments"></i> My Meets</button>
            <button id="my-profile-btn" class="nav-btn"><i class="fas fa-user-circle"></i> Profile</button>
            <button id="logout-btn" class="nav-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>
    </nav>

    <!-- HOME PAGE -->
    <div id="home-page" class="page">
        <!-- HERO SECTION ŒºŒµ background image -->
        <div class="hero-section" id="car-meet-hero">
            <div class="hero-overlay">
                <div class="hero-content">
                    <h1 class="hero-title">RatScape</h1>
                    <p class="hero-subtitle">The Ultimate Car & Bike Meetup Platform</p>
                    <p class="hero-description">Join the largest community of automotive enthusiasts. 
                        Find meets, connect with riders, and share your passion.</p>
                    
                    <div id="home-cta-logged-out">
                        <button id="home-login-btn" class="cta-btn hero-btn"><i class="fas fa-sign-in-alt"></i> Login to Start</button>
                        <button id="home-register-btn" class="cta-btn-secondary hero-btn"><i class="fas fa-user-plus"></i> Create Account</button>
                    </div>
                    <div id="home-cta-logged-in" style="display: none;">
                        <button id="create-room-btn" class="cta-btn hero-btn"><i class="fas fa-plus-circle"></i> Create Meet</button>
                        <button id="join-room-btn" class="cta-btn-secondary hero-btn"><i class="fas fa-key"></i> Join Meet</button>
                        <button id="browse-events-btn" class="cta-btn-secondary hero-btn"><i class="fas fa-calendar-alt"></i> Browse Events</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- FEATURED MEETS SECTION -->
        <div class="featured-section">
            <div class="container">
                <h2 class="section-title">Featured Car Meets</h2>
                <p class="section-subtitle">Check out the hottest meets happening near you</p>
                
                <div class="featured-grid">
                    <div class="featured-card">
                        <div class="featured-image" style="background-image: url('/images/car-meet-1.jpg');">
                            <span class="featured-badge">LIVE</span>
                        </div>
                        <div class="featured-content">
                            <h3>Athens Night Riders</h3>
                            <p class="featured-location"><i class="fas fa-map-marker-alt"></i> Athens, Greece</p>
                            <p class="featured-date"><i class="fas fa-calendar"></i> Every Friday, 20:00</p>
                            <div class="featured-stats">
                                <span><i class="fas fa-users"></i> 128 Attending</span>
                                <span><i class="fas fa-comments"></i> 45 Chatting</span>
                            </div>
                            <button class="btn btn-primary btn-block join-featured-btn">Join Meet</button>
                        </div>
                    </div>
                    
                    <div class="featured-card">
                        <div class="featured-image" style="background-image: url('/images/car-meet-2.jpg');">
                            <span class="featured-badge upcoming">UPCOMING</span>
                        </div>
                        <div class="featured-content">
                            <h3>Greek Supercar Sunday</h3>
                            <p class="featured-location"><i class="fas fa-map-marker-alt"></i> Thessaloniki, Greece</p>
                            <p class="featured-date"><i class="fas fa-calendar"></i> Next Sunday, 10:00</p>
                            <div class="featured-stats">
                                <span><i class="fas fa-users"></i> 89 Attending</span>
                                <span><i class="fas fa-comments"></i> 32 Chatting</span>
                            </div>
                            <button class="btn btn-primary btn-block join-featured-btn">Join Meet</button>
                        </div>
                    </div>
                    
                    <div class="featured-card">
                        <div class="featured-image" style="background-image: url('/images/car-meet-3.jpg');">
                            <span class="featured-badge">LIVE</span>
                        </div>
                        <div class="featured-content">
                            <h3>Classic Car Gathering</h3>
                            <p class="featured-location"><i class="fas fa-map-marker-alt"></i> Patras, Greece</p>
                            <p class="featured-date"><i class="fas fa-calendar"></i> Every Saturday, 18:00</p>
                            <div class="featured-stats">
                                <span><i class="fas fa-users"></i> 64 Attending</span>
                                <span><i class="fas fa-comments"></i> 28 Chatting</span>
                            </div>
                            <button class="btn btn-primary btn-block join-featured-btn">Join Meet</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MEET CATEGORIES -->
        <div class="categories-section">
            <div class="container">
                <h2 class="section-title">Browse by Vehicle Type</h2>
                <p class="section-subtitle">Find meets for your specific interest</p>
                
                <div class="categories-grid">
                    <div class="category-card" data-category="supercars">
                        <div class="category-icon">
                            <i class="fas fa-car"></i>
                        </div>
                        <h3>Supercars</h3>
                        <p>Lamborghini, Ferrari, Porsche meets</p>
                        <span class="category-count">12 Active Meets</span>
                    </div>
                    
                    <div class="category-card" data-category="classic">
                        <div class="category-icon">
                            <i class="fas fa-car-side"></i>
                        </div>
                        <h3>Classic Cars</h3>
                        <p>Vintage & retro car gatherings</p>
                        <span class="category-count">8 Active Meets</span>
                    </div>
                    
                    <div class="category-card" data-category="jdm">
                        <div class="category-icon">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <h3>JDM Culture</h3>
                        <p>Japanese Domestic Market meets</p>
                        <span class="category-count">15 Active Meets</span>
                    </div>
                    
                    <div class="category-card" data-category="motorcycle">
                        <div class="category-icon">
                            <i class="fas fa-motorcycle"></i>
                        </div>
                        <h3>Motorcycles</h3>
                        <p>Bike meets & rideouts</p>
                        <span class="category-count">10 Active Meets</span>
                    </div>
                    
                    <div class="category-card" data-category="diy">
                        <div class="category-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <h3>DIY & Mods</h3>
                        <p>Workshop days & mod meets</p>
                        <span class="category-count">7 Active Meets</span>
                    </div>
                    
                    <div class="category-card" data-category="racing">
                        <div class="category-icon">
                            <i class="fas fa-flag-checkered"></i>
                        </div>
                        <h3>Track Days</h3>
                        <p>Circuit events & time attacks</p>
                        <span class="category-count">5 Active Meets</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- GALLERY SECTION -->
        <div class="gallery-section">
            <div class="container">
                <h2 class="section-title">From Our Community</h2>
                <p class="section-subtitle">Real meets, real people, real passion</p>
                
                <div class="gallery-grid">
                    <div class="gallery-item">
                        <img src="/images/gallery-1.jpg" alt="Car Meet" class="gallery-image">
                        <div class="gallery-overlay">
                            <p>Athens Night Meet</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="/images/gallery-2.jpg" alt="Bike Meet" class="gallery-image">
                        <div class="gallery-overlay">
                            <p>Bike Rideout</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="/images/gallery-3.jpg" alt="Car Show" class="gallery-image">
                        <div class="gallery-overlay">
                            <p>Car Show 2024</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="/images/gallery-4.jpg" alt="Workshop" class="gallery-image">
                        <div class="gallery-overlay">
                            <p>Modding Workshop</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STATS SECTION -->
        <div class="stats-section">
            <div class="container">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="total-meets">250+</div>
                        <div class="stat-label">Active Meets</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-users">5,000+</div>
                        <div class="stat-label">Community Members</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-events">120+</div>
                        <div class="stat-label">Events This Month</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="total-countries">15+</div>
                        <div class="stat-label">Countries</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SOCIAL MEDIA FOOTER SECTION -->
        <div class="social-media-section">
            <div class="container">
                <h2 class="section-title">Join Our Social Community</h2>
                <p class="section-subtitle">Connect with us for updates, news, and to meet other automotive enthusiasts!</p>
                
                <div class="social-icons-grid">
                    <a href="https://www.instagram.com/ratscape.official/" target="_blank" 
                       class="social-icon-circle instagram" title="Instagram"
                       onclick="trackSocialMediaClick('instagram')">
                        <i class="fab fa-instagram"></i>
                        <span class="social-icon-label">Instagram</span>
                    </a>
                    
                    <a href="https://www.facebook.com/profile.php?id=61586110163264" target="_blank" 
                       class="social-icon-circle facebook" title="Facebook"
                       onclick="trackSocialMediaClick('facebook')">
                        <i class="fab fa-facebook-f"></i>
                        <span class="social-icon-label">Facebook</span>
                    </a>
                    
                    <a href="https://x.com/Ratscapee" target="_blank" 
                       class="social-icon-circle twitter" title="Twitter"
                       onclick="trackSocialMediaClick('twitter')">
                        <i class="fab fa-twitter"></i>
                        <span class="social-icon-label">Twitter</span>
                    </a>
                    
                    <a href="https://www.youtube.com/@RatScape" target="_blank" 
                       class="social-icon-circle youtube" title="YouTube"
                       onclick="trackSocialMediaClick('youtube')">
                        <i class="fab fa-youtube"></i>
                        <span class="social-icon-label">YouTube</span>
                    </a>
                    
                    <a href="https://discord.gg/ratscape" target="_blank" 
                       class="social-icon-circle discord" title="Discord"
                       onclick="trackSocialMediaClick('discord')">
                        <i class="fab fa-discord"></i>
                        <span class="social-icon-label">Discord</span>
                    </a>
                </div>
                
                <p class="follow-us">
                    Follow us for the latest updates on car meets, events, and community news!
                </p>
            </div>
        </div>
    </div>

    <!-- MY ROOMS PAGE -->
    <div id="rooms-page" class="page">
        <div class="rooms-container">
            <div class="rooms-header">
                <h2>My Meets</h2>
                <div class="rooms-actions">
                    <button id="create-room-btn-2" class="btn btn-primary"><i class="fas fa-plus-circle"></i> Create Meet</button>
                    <button id="join-room-btn-2" class="btn btn-secondary"><i class="fas fa-key"></i> Join Meet</button>
                </div>
            </div>
            <div id="rooms-list" class="rooms-list">
                <!-- Rooms will be loaded here -->
            </div>
        </div>
    </div>

    <!-- MY FRIENDS PAGE -->
    <div id="friends-page" class="page">
        <div class="rooms-container">
            <div class="rooms-header">
                <h2>My Friends</h2>
                <div class="rooms-actions">
                    <button id="add-friend-btn" class="btn btn-primary"><i class="fas fa-user-plus"></i> Add Friend</button>
                </div>
            </div>

            <!-- My Username Display -->
            <div class="my-username-card">
                <div class="my-username-header">
                    <span>Your Username:</span>
                    <div class="username-display">
                        <span id="display-my-username" class="username-text">username</span>
                        <button id="copy-username-btn" class="btn-icon" title="Copy username"><i class="fas fa-copy"></i></button>
                    </div>
                </div>
                <p class="username-hint">Share this username with friends so they can add you!</p>
            </div>

            <div id="friends-list" class="friends-list-page">
                <!-- Friends will be loaded here -->
            </div>
        </div>
    </div>

    <!-- MY PROFILE PAGE -->
    <div id="profile-page" class="page">
        <div class="rooms-container">
            <div class="rooms-header">
                <h2>My Profile</h2>
                <button id="back-from-profile-btn" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
            </div>

            <div class="profile-container">
                <!-- Profile Picture -->
                <div class="profile-picture-section">
                    <div class="profile-picture-container">
                        <div class="profile-image-wrapper">
                            <img id="profile-image" src="" alt="Profile Picture" class="profile-image">
                            <div class="profile-image-overlay">
                                <button id="change-profile-pic-btn" class="btn-icon">
                                    <i class="fas fa-camera"></i>
                                </button>
                            </div>
                        </div>
                        <input type="file" id="profile-image-input" accept="image/*" style="display: none;">
                    </div>
                    <h3 id="profile-username">Username</h3>
                    <p class="profile-email" id="profile-email">Email</p>
                </div>

                <!-- Profile Info -->
                <div class="profile-info-section">
                    <div class="info-card">
                        <h3>Profile Information</h3>
                        <div class="info-item">
                            <label>Username:</label>
                            <span id="info-username" class="info-value">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Email:</label>
                            <span id="info-email" class="info-value">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Status:</label>
                            <span id="info-status" class="info-value status-online">Loading...</span>
                        </div>
                        <div class="info-item">
                            <label>Joined:</label>
                            <span id="info-joined" class="info-value">Loading...</span>
                        </div>
                    </div>

                    <!-- Statistics -->
                    <div class="stats-card">
                        <h3>Your Statistics</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value" id="stat-friends">0</div>
                                <div class="stat-label">Friends</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="stat-rooms">0</div>
                                <div class="stat-label">Meets</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="stat-messages">0</div>
                                <div class="stat-label">Messages</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="stat-events">0</div>
                                <div class="stat-label">Events</div>
                            </div>
                        </div>
                    </div>

                    <!-- Profile Actions -->
                    <div class="profile-actions">
                        <button id="edit-profile-btn" class="btn btn-primary">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                        <button id="change-password-btn" class="btn btn-secondary">
                            <i class="fas fa-key"></i> Change Password
                        </button>
                        <button id="my-events-btn" class="btn btn-secondary">
                            <i class="fas fa-calendar-alt"></i> My Events
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CHAT PAGE -->
    <div id="chat-page" class="page">
        <div class="chat-layout">
            <!-- SIDEBAR -->
            <div id="sidebar">
                <div class="sidebar-header">
                    <h2 id="room-name-sidebar">RatScape</h2>
                    <div class="room-info">
                        <div class="status-dot"></div>
                        <span id="room-status">Loading...</span>
                    </div>
                </div>

                <!-- Room Info -->
                <div class="room-details" id="invite-code-container">
                    <div class="invite-code-section">
                        <label>Meet Code:</label>
                        <div class="invite-code-display">
                            <span id="room-invite-code">------</span>
                            <button id="copy-invite-btn" class="btn-icon" title="Copy meet code"><i class="fas fa-copy"></i></button>
                        </div>
                    </div>
                    <div class="room-actions">
                        <button id="create-event-btn" class="btn btn-primary btn-sm btn-block">
                            <i class="fas fa-calendar-plus"></i> Create Event
                        </button>
                    </div>
                </div>

                <!-- Room Events -->
                <div class="room-events-section" id="events-section">
                    <h3><i class="fas fa-calendar-alt"></i> MEET EVENTS</h3>
                    <div id="room-events-list" class="events-list">
                        <!-- Events will be loaded here -->
                    </div>
                </div>

                <!-- Room Members -->
                <div class="room-members-section">
                    <h3>MEMBERS</h3>
                    <div id="room-members-list">
                        <!-- Members will be loaded here -->
                    </div>
                </div>

                <!-- User Profile -->
                <div class="user-profile">
                    <div class="profile-avatar">
                        <div class="avatar" id="sidebar-avatar">U</div>
                    </div>
                    <div class="profile-info">
                        <span class="profile-name" id="sidebar-username">User</span>
                        <span class="profile-status">Online</span>
                    </div>
                    <button id="leave-room-btn" class="btn-icon" title="Leave meet"><i class="fas fa-sign-out-alt"></i></button>
                </div>
            </div>

            <!-- MAIN CHAT -->
            <div id="main-chat">
                <div class="chat-header">
                    <div class="chat-info">
                        <h2 id="room-name-header">Meet Name</h2>
                        <span class="chat-description" id="room-description">Car meet chat</span>
                    </div>
                    <div class="chat-actions">
                        <button class="action-btn clear-btn" id="clear-messages-btn"><i class="fas fa-trash"></i> Clear</button>
                    </div>
                </div>

                <!-- MESSAGES AREA -->
                <div id="messages-container">
                    <!-- Messages will be loaded here -->
                </div>

                <!-- FILE UPLOAD PREVIEW -->
                <div id="file-preview" class="file-preview-container" style="display: none;">
                    <div class="file-preview-header">
                        <div class="file-preview-title">
                            <i class="fas fa-file-upload"></i> ŒëœÅœáŒµŒØŒø œÄœÅŒøœÇ Œ±œÄŒøœÉœÑŒøŒªŒÆ
                        </div>
                        <button id="cancel-upload-btn" class="btn-icon" title="Cancel">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="file-preview-content">
                        <img id="preview-image" src="" alt="Preview">
                        <div class="file-info">
                            <div class="file-info-row">
                                <span id="file-name" class="file-name"></span>
                            </div>
                            <div class="file-info-row">
                                <span id="file-size" class="file-size"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-progress-container">
                        <div id="upload-progress" data-progress="0%"></div>
                    </div>
                    
                    <div id="upload-status" class="upload-status"></div>
                    
                    <div class="file-upload-actions">
                        <button id="send-file-btn" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> ŒëœÄŒøœÉœÑŒøŒªŒÆ ŒëœÅœáŒµŒØŒøœÖ
                        </button>
                    </div>
                </div>

                <!-- MESSAGE INPUT WITH FILE UPLOAD & EMOJI PICKER -->
                <div class="message-input-container">
                    <form id="chat-form">
                        <div class="input-actions">
                            <button type="button" class="file-upload-btn" title="Upload file">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            
                            <button type="button" class="emoji-picker-btn" title="Emoji picker">
                                <i class="fas fa-smile"></i>
                            </button>
                        </div>
                        
                        <input type="file" id="file-upload-input" accept="image/*, .pdf, .doc, .docx, .txt" style="display: none;">
                        
                        <textarea id="message-input" autocomplete="off" placeholder="Type your message..." rows="1"></textarea>
                        
                        <button type="submit" class="send-btn">
                            <i class="fas fa-paper-plane"></i> Send
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- EVENT PAGE -->
    <div id="event-page" class="page">
        <!-- This will be generated dynamically by JavaScript -->
    </div>

    <!-- EMOJI PICKER MODAL -->
    <div class="modal" id="emoji-picker-modal">
        <div class="emoji-picker-content">
            <div class="emoji-picker-header">
                <h3>Emoji Picker</h3>
                <button class="close-modal-btn" id="close-emoji-picker">√ó</button>
            </div>
            
            <div class="emoji-categories" id="emoji-categories">
                <!-- Emoji categories will be loaded here -->
            </div>
            
            <div class="emoji-grid-container">
                <div class="emoji-grid" id="emoji-grid">
                    <!-- Emojis will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- CREATE EVENT MODAL -->
    <div class="modal" id="create-event-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Event</h3>
                <button class="close-modal-btn" id="close-create-event-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="event-title">Event Title</label>
                    <input type="text" id="event-title" placeholder="e.g., Friday Night Meet">
                </div>
                <div class="form-group">
                    <label for="event-date">Date & Time</label>
                    <input type="datetime-local" id="event-date">
                </div>
                <div class="form-group">
                    <label for="event-location">Location</label>
                    <input type="text" id="event-location" placeholder="e.g., Syntagma Square, Athens">
                </div>
                <div class="form-group">
                    <label for="event-description">Description</label>
                    <textarea id="event-description" placeholder="Describe your event..." rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label for="event-image">Event Image (Optional)</label>
                    <input type="file" id="event-image" accept="image/*">
                    <div class="image-preview" id="event-image-preview"></div>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="event-private"> Private Event (Meet Members Only)
                    </label>
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="create-event-submit">
                        <i class="fas fa-calendar-plus"></i> Create Event
                    </button>
                    <button class="btn btn-secondary" id="cancel-create-event">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- LOGIN MODAL -->
    <div class="modal" id="login-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Login to RatScape</h3>
                <button class="close-modal-btn" id="close-login-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="login-submit"><i class="fas fa-sign-in-alt"></i> Login</button>
                    <button class="btn btn-secondary" id="login-cancel">Cancel</button>
                </div>
                <div class="guest-section">
                    <p>Don't have an account?</p>
                    <button class="btn btn-guest" id="switch-to-register"><i class="fas fa-user-plus"></i> Create Account</button>
                </div>
            </div>
        </div>
    </div>

    <!-- REGISTER MODAL -->
    <div class="modal" id="register-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Join RatScape</h3>
                <button class="close-modal-btn" id="close-register-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="registration-avatar-section">
                    <div class="registration-avatar-preview">
                        <img id="register-avatar-preview" src="" style="display: none;">
                        <div id="register-avatar-placeholder" class="registration-avatar-placeholder">
                            <i class="fas fa-user"></i>
                            <span>No photo</span>
                        </div>
                    </div>
                    <div class="registration-avatar-buttons">
                        <button type="button" id="register-browse-btn" class="btn btn-secondary btn-sm">
                            <i class="fas fa-folder-open"></i> Browse
                        </button>
                        <input type="file" id="register-avatar-input" accept="image/*" style="display: none;">
                    </div>
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label for="register-username">Username</label>
                    <input type="text" id="register-username" placeholder="Choose a username">
                </div>
                <div class="form-group">
                    <label for="register-password">Password</label>
                    <input type="password" id="register-password" placeholder="Create a password">
                </div>
                <div class="form-group">
                    <label for="register-confirm">Confirm Password</label>
                    <input type="password" id="register-confirm" placeholder="Confirm your password">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="register-submit"><i class="fas fa-user-plus"></i> Create Account</button>
                    <button class="btn btn-secondary" id="register-cancel">Cancel</button>
                </div>
                <div class="guest-section">
                    <p>Already have an account?</p>
                    <button class="btn btn-guest" id="switch-to-login"><i class="fas fa-sign-in-alt"></i> Sign In</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CREATE ROOM MODAL -->
    <div class="modal" id="create-room-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Meet</h3>
                <button class="close-modal-btn" id="close-create-room-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="room-name-input">Meet Name</label>
                    <input type="text" id="room-name-input" placeholder="Enter meet name">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="create-room-submit"><i class="fas fa-plus-circle"></i> Create Meet</button>
                    <button class="btn btn-secondary" id="create-room-cancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JOIN ROOM MODAL -->
    <div class="modal" id="join-room-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Join Meet with Code</h3>
                <button class="close-modal-btn" id="close-join-room-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="invite-code-input">Meet Code</label>
                    <input type="text" id="invite-code-input" placeholder="Enter meet code" style="text-transform: uppercase;">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="join-room-submit"><i class="fas fa-key"></i> Join Meet</button>
                    <button class="btn btn-secondary" id="join-room-cancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ADD FRIEND MODAL -->
    <div class="modal" id="add-friend-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Friend</h3>
                <button class="close-modal-btn" id="close-add-friend-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="friend-username-input">Friend's Username</label>
                    <input type="text" id="friend-username-input" placeholder="Enter username">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="add-friend-submit"><i class="fas fa-user-plus"></i> Add Friend</button>
                    <button class="btn btn-secondary" id="add-friend-cancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- EDIT PROFILE MODAL -->
    <div class="modal" id="edit-profile-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Profile</h3>
                <button class="close-modal-btn" id="close-edit-profile-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="edit-username">Username</label>
                    <input type="text" id="edit-username" placeholder="Enter new username">
                </div>
                <div class="form-group">
                    <label for="edit-email">Email</label>
                    <input type="email" id="edit-email" placeholder="Enter new email">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="save-profile-btn"><i class="fas fa-save"></i> Save Changes</button>
                    <button class="btn btn-secondary" id="cancel-edit-profile-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CHANGE PASSWORD MODAL -->
    <div class="modal" id="change-password-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Change Password</h3>
                <button class="close-modal-btn" id="close-change-password-modal">√ó</button>
            </div>
            <div class="form-container active">
                <div class="form-group">
                    <label for="current-password">Current Password</label>
                    <input type="password" id="current-password" placeholder="Enter current password">
                </div>
                <div class="form-group">
                    <label for="new-password">New Password</label>
                    <input type="password" id="new-password" placeholder="Enter new password">
                </div>
                <div class="form-group">
                    <label for="confirm-new-password">Confirm New Password</label>
                    <input type="password" id="confirm-new-password" placeholder="Confirm new password">
                </div>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="save-password-btn"><i class="fas fa-key"></i> Change Password</button>
                    <button class="btn btn-secondary" id="cancel-password-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- USER INFO MODAL -->
    <div class="modal" id="user-info-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="user-info-title">User Profile</h3>
                <button class="close-modal-btn" id="close-user-info-modal">√ó</button>
            </div>

            <div class="form-container active">
                <div class="user-info-container">
                    <div class="user-info-picture">
                        <img id="user-info-image" src="" alt="User Picture" class="user-info-image" onerror="this.src='default-avatar.png'">
                    </div>
                    
                    <div class="user-info-details">
                        <div class="info-item">
                            <label>Username:</label>
                            <span id="user-info-username" class="info-value">username</span>
                        </div>
                        <div class="info-item">
                            <label>Status:</label>
                            <span id="user-info-status" class="info-value status-online">Online</span>
                        </div>
                        <div class="info-item">
                            <label>Joined:</label>
                            <span id="user-info-joined" class="info-value">Loading...</span>
                        </div>
                    </div>

                    <div class="user-info-actions">
                        <button id="send-private-message-btn" class="btn btn-primary">
                            <i class="fas fa-comment"></i> Send Message
                        </button>
                        <button id="add-as-friend-btn" class="btn btn-secondary" style="display: none;">
                            <i class="fas fa-user-plus"></i> Add Friend
                        </button>
                        <button id="view-mutual-rooms-btn" class="btn btn-secondary">
                            <i class="fas fa-door-open"></i> Mutual Meets
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CONFIRMATION MODAL (Dynamic) -->
    <!-- This modal is created dynamically in client.js -->

    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
    
    <!-- PWA SCRIPT -->
    <script>
    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then((registration) => {
            console.log('‚úÖ Service Worker registered:', registration.scope);
          })
          .catch((error) => {
            console.log('‚ùå Service Worker registration failed:', error);
          });
      });
    }

    // PWA Install Management
    let deferredPrompt;
    let installButton = document.getElementById('pwa-install-btn');

    function showInstallButton() {
      const homePageActive = document.getElementById('home-page').classList.contains('active');
      const isPWA = window.matchMedia('(display-mode: standalone)').matches || 
                    window.navigator.standalone === true;
      
      if (installButton && homePageActive && !isPWA) {
        installButton.style.display = 'flex';
        installButton.classList.add('fade-in');
      } else {
        installButton.style.display = 'none';
        installButton.classList.remove('fade-in');
      }
    }

    function hideInstallButton() {
      if (installButton) {
        installButton.style.display = 'none';
        installButton.classList.remove('fade-in');
      }
    }

    window.addEventListener('beforeinstallprompt', (e) => {
      console.log('üì± PWA Install Prompt triggered');
      e.preventDefault();
      deferredPrompt = e;
      showInstallButton();
    });

    window.installPWA = async () => {
      if (deferredPrompt) {
        console.log('üì≤ Starting PWA installation with browser prompt...');
        
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        
        console.log(`üì± User ${outcome === 'accepted' ? 'accepted' : 'dismissed'} installation`);
        
        if (outcome === 'accepted') {
          if (typeof showNotification === 'function') {
            showNotification('App installed successfully!', 'success', 'Welcome to RatScape!');
          }
          hideInstallButton();
        }
        
        deferredPrompt = null;
      } else {
        console.log('‚ÑπÔ∏è No install prompt available, showing instructions');
        if (typeof showNotification === 'function') {
          showNotification('Look for the install option in your browser menu!', 'info', 'Install RatScape');
        }
      }
    };

    window.addEventListener('load', () => {
      const isPWA = window.matchMedia('(display-mode: standalone)').matches || 
                    window.navigator.standalone === true;
      
      if (isPWA) {
        console.log('‚úÖ Running as PWA');
        document.body.classList.add('pwa-mode');
        hideInstallButton();
      } else {
        console.log('üåê Running in browser');
        document.body.classList.remove('pwa-mode');
        setTimeout(showInstallButton, 1000);
      }
    });

    const observer = new MutationObserver(() => {
      showInstallButton();
    });

    document.querySelectorAll('.page').forEach(page => {
      observer.observe(page, { 
        attributes: true, 
        attributeFilter: ['class'] 
      });
    });

    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(showInstallButton, 1500);
    });
    
    // ===== ŒöŒ•Œ°ŒôŒü FIX: ŒëœÖœÑœåŒºŒ±œÑŒ∑ ŒµœÄŒ±ŒΩŒ±œÜŒøœÅŒ¨ œÑŒ∑œÇ œÑŒµŒªŒµœÖœÑŒ±ŒØŒ±œÇ œÉŒµŒªŒØŒ¥Œ±œÇ =====
    document.addEventListener('DOMContentLoaded', function() {
        // Œ†ŒµœÅŒØŒºŒµŒΩŒµ ŒªŒØŒ≥Œø Œ≥ŒπŒ± ŒΩŒ± œÜŒøœÅœÑœéœÉŒµŒπ œÑŒø DOM
        setTimeout(function() {
            const lastPageId = getLastPageId();
            console.log('üîÑ ŒïœÄŒ±ŒΩŒ±œÜŒøœÅŒ¨ œÉŒµŒªŒØŒ¥Œ±œÇ Œ±œÄœå œÑŒø refresh:', lastPageId);
            
            // ŒëœÜŒ±ŒØœÅŒµœÉŒ∑ œÑŒøœÖ "active" class Œ±œÄœå œåŒªŒµœÇ œÑŒπœÇ œÉŒµŒªŒØŒ¥ŒµœÇ
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Œ†œÅœåœÉŒ∏ŒµœÉŒ∑ œÑŒøœÖ "active" class œÉœÑŒ∑ œÉœâœÉœÑŒÆ œÉŒµŒªŒØŒ¥Œ±
            const targetPage = document.getElementById(lastPageId);
            if (targetPage) {
                targetPage.classList.add('active');
                setCurrentPageId(lastPageId);
                console.log('‚úÖ ŒïœÄŒ±ŒΩŒ±œÜŒ≠œÅŒ∏Œ∑Œ∫Œµ œÉŒµŒªŒØŒ¥Œ±:', lastPageId);
            } else {
                // ŒëŒΩ Œ¥ŒµŒΩ Œ≤œÅŒµŒ∏ŒµŒØ Œ∑ œÉŒµŒªŒØŒ¥Œ±, œÄŒÆŒ≥Œ±ŒπŒΩŒµ œÉœÑŒ∑ŒΩ home
                document.getElementById('home-page').classList.add('active');
                setCurrentPageId('home-page');
                console.log('‚ö†Ô∏è Œó œÉŒµŒªŒØŒ¥Œ± Œ¥ŒµŒΩ Œ≤œÅŒ≠Œ∏Œ∑Œ∫Œµ, ŒµœÄŒπœÉœÑœÅŒøœÜŒÆ œÉœÑŒ∑ŒΩ home');
            }
        }, 100);
    });
    
    // ===== ŒíŒüŒóŒòŒóŒ§ŒôŒöŒó Œ£Œ•ŒùŒëŒ°Œ§ŒóŒ£Œó ŒìŒôŒë SOCIAL MEDIA LINKS =====
    function trackSocialMediaClick(platform) {
        console.log(`üì± Social media click: ${platform}`);
        // ŒïŒ¥œé ŒºœÄŒøœÅŒµŒØœÇ ŒΩŒ± œÄœÅŒøœÉŒ∏Œ≠œÉŒµŒπœÇ analytics tracking
        // œÄ.œá. Google Analytics, Facebook Pixel, Œ∫ŒªœÄ.
    }
    
    // Œ†œÅŒøœÉŒ∏ŒÆŒ∫Œ∑ event listeners œÉœÑŒ± social media links
    document.addEventListener('DOMContentLoaded', function() {
        const socialLinks = document.querySelectorAll('.social-icon-circle');
        socialLinks.forEach(link => {
            link.addEventListener('click', function() {
                const platform = this.classList[1]; // œÄŒ±ŒØœÅŒΩŒøœÖŒºŒµ œÑŒ∑ŒΩ Œ∫ŒªŒ¨œÉŒ∑ (instagram, facebook, Œ∫ŒªœÄ.)
                trackSocialMediaClick(platform);
            });
        });
        
        // Browse events button
        const browseEventsBtn = document.getElementById('browse-events-btn');
        if (browseEventsBtn) {
            browseEventsBtn.addEventListener('click', function() {
                showNotification('Events feature coming soon!', 'info', 'Coming Soon');
            });
        }
        
        // Join featured meet buttons
        document.querySelectorAll('.join-featured-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                showNotification('Please login to join meets', 'info', 'Login Required');
            });
        });
    });
    </script>
</body>

</html>
